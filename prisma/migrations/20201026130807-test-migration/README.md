# Migration `20201026130807-test-migration`

This migration has been generated by joswambugu at 10/26/2020, 4:08:07 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."User_addressId_unique"

ALTER TABLE "public"."User" DROP CONSTRAINT "User_addressId_fkey"

ALTER TABLE "public"."Address" ADD COLUMN "userId" integer   

ALTER TABLE "public"."User" DROP COLUMN "addressId"

CREATE UNIQUE INDEX "Address_userId_unique" ON "public"."Address"("userId")

ALTER TABLE "public"."Address" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201026124743-test-migration..20201026130807-test-migration
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -16,13 +16,12 @@
 email           String     @unique
 password        String
 booked          Boolean    @default(false)
 role            Role       @default(PASSENGER)
-address         Address   @relation(fields: [addressId],references:[id])
+address         Address  
 busBooked       Bus ?       @relation(fields: [busId],references:[id])
 transactions    Transaction[]
 busId           Int?
-addressId       Int
 createdAt       DateTime   @default(now())
 updatedAt       DateTime   @updatedAt  
 }
@@ -30,9 +29,10 @@
 model Address{
 id           Int         @id @default(autoincrement())  
 county       String
 city         String
-user         User        
+user         User?        @relation(fields: [userId],references:[id])   
+userId       Int?  
 createdAt    DateTime     @default(now())
 updatedAt    DateTime      @updatedAt  
```


